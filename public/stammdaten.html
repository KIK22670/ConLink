<!DOCTYPE html>
<html lang="en">

<head>
    <title>ConLink - Stammdaten</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <!-- Header aus der Home-Seite -->
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/all.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/doctorsearch.css" />
    <link rel="stylesheet" href="css/stylehome.css" />

    <style>
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-left: 27%;
        }

        .card-header {
            background-color: #1b9aaa;
            color: #ffffff;
            border-bottom: none;
            border-radius: 15px 15px 0 0;
        }

        .card-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            font-weight: bold;
            color: #1b9aaa;
        }

        .btn-primary {
            background-color: #1b9aaa;
            border: none;
            padding: 10px 20px;
            font-size: 1.2rem;
        }

        .btn-primary:hover {
            background-color: #14768c;
        }
    </style>
</head>

<body>
    <!-- Navbar aus der Home-Seite -->
    <div class="container-fluid sticky-top bg-white shadow-sm">
        <div class="container">
            <nav class="navbar navbar-expand-lg bg-white navbar-light py-3 py-lg-0">
                <a href="home.html" class="navbar-brand">
                    <img src="img/logo.png" class="logo-img" />
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <div class="navbar-nav ms-auto py-0">
                        <a href="home.html" class="nav-item nav-link active">Home</a>
                        <a href="aboutus.html" class="nav-item nav-link">About Us</a>
                        <a href="faq.html" class="nav-item nav-link">FAQ</a>
                        <a href="/logout" class="nav-item nav-link">Logout</a>
                    </div>
                </div>
            </nav>
        </div>
    </div>
    <!-- Ende Navbar -->

    <!-- Linke Navbar -->
    <nav class="navbar left-navbar">
        <div class="container">
            <div class="navbar-nav">
                <a href="stammdaten.html" class="nav-item nav-link">
                    <i class="bi bi-person-check"></i> Stammdaten
                </a>

                <a href="doctorsearch.html" class="nav-item nav-link">
                    <i class="fas fa-user-md"></i> Ärztesuche
                </a>
                <a href="appoitmentoverview.html" class="nav-item nav-link">
                    <i class="bi bi-calendar"></i> Termine
                </a>
            </div>
        </div>
    </nav>
    <!-- Ende linke Navbar -->

    <div class="container mt-5" style="max-width: 800px; margin-left: auto; margin-right: auto;">
        <div class="card">
            <div class="card-header">
                Stammdaten
            </div>
            <div class="card-body">
                <form id="stammdatenForm">
                    <div class="form-group">
                        <label for="p_vorname">Vorname:</label>
                        <input type="text" class="form-control" id="p_vorname" name="p_vorname">
                    </div>

                    <div class="form-group">
                        <label for="p_nachname">Nachname:</label>
                        <input type="text" class="form-control" id="p_nachname" name="p_nachname">
                    </div>

                    <div class="form-group">
                        <label for="p_email">E-Mail:</label>
                        <input type="email" class="form-control" id="p_email" name="p_email">
                    </div>

                    <div class="form-group">
                        <label for="p_telefonnummer">Telefonnummer:</label>
                        <input type="tel" class="form-control" id="p_telefonnummer" name="p_telefonnummer">
                    </div>

                    <div class="form-group">
                        <label for="p_geburtsdatum">Geburtsdatum:</label>
                        <input type="date" class="form-control" id="p_geburtsdatum" name="p_geburtsdatum">
                    </div>

                    <div class="form-group">
                        <label for="p_svnr">SVNR:</label>
                        <input type="text" class="form-control" id="p_svnr" name="p_svnr">
                    </div>

                    <div class="form-group">
                        <label for="p_allergien">Allergien:</label>
                        <textarea class="form-control" id="p_allergien" name="p_allergien"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="p_vorerkrankungen">Vorerkrankungen:</label>
                        <textarea class="form-control" id="p_vorerkrankungen" name="p_vorerkrankungen"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="p_medikamente">Medikamente:</label>
                        <textarea class="form-control" id="p_medikamente" name="p_medikamente"></textarea>
                    </div>

                    <div class="mt-3">
                        <button type="button" class="btn btn-primary" onclick="stammdatenSpeichern()">Speichern</button>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <script>

        // Lade die Stammdaten beim Laden der Seite
        window.onload = function () {
            ladeStammdaten();
        };

        function ladeStammdaten() {
            fetch('/ladeStammdaten')  // Ersetze '/ladeStammdaten' durch den richtigen Endpunkt auf deinem Server
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Wenn die Stammdaten vorhanden sind, setze die Formularfelder
                        const stammdaten = JSON.parse(data.stammdaten);
                        document.getElementById('p_vorname').value = stammdaten.vorname;
                        document.getElementById('p_nachname').value = stammdaten.nachname;
                        document.getElementById('p_email').value = stammdaten.email;
                        document.getElementById('p_telefonnummer').value = stammdaten.telefonnummer;
                        document.getElementById('p_geburtsdatum').value = stammdaten.geburtsdatum;
                        document.getElementById('p_svnr').value = stammdaten.svnr;
                        document.getElementById('p_allergien').value = stammdaten.allergien;
                        document.getElementById('p_vorerkrankungen').value = stammdaten.vorerkrankungen;
                        document.getElementById('p_medikamente').value = stammdaten.medikamente;
                    }
                })
                .catch(error => {
                    console.error('Fehler beim Laden der Stammdaten:', error);
                });
        }


        function stammdatenSpeichern() {
            const vorname = document.getElementById('p_vorname').value;
            const nachname = document.getElementById('p_nachname').value;
            const email = document.getElementById('p_email').value;
            const telefonnummer = document.getElementById('p_telefonnummer').value;
            const gebElement = document.getElementById('p_geburtsdatum');
            const geb = gebElement.value ? gebElement.value : null;
            const svnr = document.getElementById('p_svnr').value;
            const allergien = document.getElementById('p_allergien').value;
            const vorerkrankungen = document.getElementById('p_vorerkrankungen').value;
            const medikamente = document.getElementById('p_medikamente').value;

            fetch('/speichereStammdaten', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    vorname: vorname,
                    nachname: nachname,
                    email: email,
                    telefonnummer: telefonnummer,
                    geb: geb,
                    svnr: svnr,
                    allergien: allergien,
                    vorerkrankungen: vorerkrankungen,
                    medikamente: medikamente
                })
            })
                .then(response => response.json())
                .then(data => {
                    console.log('Stammdaten erfolgreich gespeichert:', data);
                    // Fügen Sie hier weitere Aktionen nach erfolgreicher Speicherung hinzu
                })
                .catch(error => {
                    console.error('Fehler beim Speichern der Stammdaten:', error);
                    // Fügen Sie hier Aktionen für den Fall eines Fehlers hinzu
                });
        }

    </script>

    <!-- Footer aus der Home-Seite -->
    <div class="container-fluid bg-dark text-light border-top border-secondary py-4">
        <div class="container">
            <div class="row g-5">
                <div class="col-md-6 text-center text-md-start">
                    <p class="mb-md-0">&copy; <a class="text-primary" href="#">ConLink</a></p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <a href="impressum.html" style="margin-right: 10px;">Impressum</a>
                    <a href="datenschutz.html">Datenschutz</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Ende Footer -->

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
    <script src="lib/tempusdominus/js/moment.min.js"></script>
    <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
    <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>

</html>